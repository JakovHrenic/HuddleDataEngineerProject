CREATE TABLE transactions (
  BETDATAID INT PRIMARY KEY,
  TIMESTAMP TIMESTAMP,
  CUSTOMERID INT,
  OUTCOMEID INT,
  TRANSACTIONID INT,
  PRICE DECIMAL(10, 2),
  UNITSTAKE DECIMAL(10, 2),
  EVENTID INT,
  EVENTDESCRIPTION VARCHAR(255),
  MARKETDESCRIPTION VARCHAR(255),
  OUTCOMEDESCRIPTION VARCHAR(255),
  SUBTYPEDESCRIPTION VARCHAR(255)
);


CREATE TABLE settlements (
  BETDATAID INT PRIMARY KEY,
  TRANSACTIONID INT,
  VERDICT CHAR(1)
);

CREATE TABLE withdrawals (
  ACCOUNTID INT,
  AMOUNT DECIMAL(10, 2)
);



-- Insert data into the transactions table
INSERT INTO transactions (BETDATAID, TIMESTAMP, CUSTOMERID, OUTCOMEID, TRANSACTIONID, PRICE, UNITSTAKE, EVENTID, EVENTDESCRIPTION, MARKETDESCRIPTION, OUTCOMEDESCRIPTION, SUBTYPEDESCRIPTION)
VALUES ();

-- Insert data into the settlements table
INSERT INTO settlements (BETDATAID, TRANSACTIONID, VERDICT)
VALUES ();

-- Insert data into the withdrawals table
INSERT INTO withdrawals (ACCOUNTID, AMOUNT)
VALUES ();


-- reports for Steps 5 and 6


SELECT
  CUSTOMERID,
  SUM(CASE WHEN verdict = 'W' THEN UNITSTAKE * PRICE ELSE 0 END) AS TotalWon,
  SUM(CASE WHEN verdict = 'L' THEN UNITSTAKE * PRICE ELSE 0 END) AS TotalLost
FROM
  transactions
GROUP BY
  CUSTOMERID;


SELECT
  CUSTOMERID,
  SUM(CASE WHEN eventType = 'WITHDRAWAL' THEN amount ELSE 0 END) AS TotalWithdrawn
FROM
  settlementswithdrawals
GROUP BY
  CUSTOMERID;